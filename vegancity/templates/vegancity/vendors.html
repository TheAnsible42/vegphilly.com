{% extends "vegancity/base.html" %}

{% load url from future %}

{% block header_extra %}
<link href="{{ STATIC_URL }}css/vegancity.css" rel="stylesheet"/>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
{% endblock %}

{% block headline %}search{% endblock %}

{% block summary %}
find some delicious vegan food now!
{% endblock %}

{% block content %}

{% block map %}
{% if result_set.0.vendors %}
<div id="map_canvas" ></div>

<script type="text/javascript" src="//maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="{{ STATIC_URL }}/js/map.js"></script>
<script type="text/javascript">

var vendors = [
{% for vendor in vendors  %}{% if vendor.latitude %}
  [{{ vendor.latitude }}, {{vendor.longitude }}, 
   '\
    <strong><a href="{%url 'vendor_detail' vendor_id=vendor.id %}">{{vendor.name}}</a></strong><br/>\
    {{vendor.address}}<br/>\
    {{vendor.phone}}<br/>\
    {url: <a href="http://{{vendor.website}}">{{vendor.website}}</a><br/>\
    '],
{% endif %}{% endfor %}
];
jQuery("body").ready(createMap(vendors));
</script>
{% endif %}
{% endblock %}

{% for result in result_set %}

<br/><h4>{{ result.summary_statement }}</h4><br/>

<table id="vendorList">
  <thead>
    <tr>
      <th>id</th>
      <th>name</th>
      <th>veg_level</th>
      <th>address</th>
      <th>phone</th>
      <th>website</th>
      <th>notes</th>
    </tr>
  </thead>
  <tbody>
    {% for vendor in result.vendors %}
    <tr>
      <td>{{ vendor.id }}</td>
      <td><a href="{% url 'vendor_detail' vendor_id=vendor.id %}">{{ vendor.name }}</a></td>
      <td>{{ vendor.veg_level }}</td>
      <td>{{ vendor.address }}</td>
      <td>{{ vendor.phone }}</td>
      <td>{{ vendor.website }}</td>
      <td>{{ vendor.notes }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endfor %}
{% endblock %}
