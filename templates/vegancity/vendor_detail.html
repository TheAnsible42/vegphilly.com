{% extends "base.html" %}

{% load url from future %}

{% load vegancity_template_tags %}

{% block title %}VegPhilly | {{ vendor.name }}{% endblock %}

{% block header_extra %}
  <script type="text/javascript" src="//maps.googleapis.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript">
    var vendors = [
    [{{ vendor.latitude }}, {{vendor.longitude }}],
    ];
  </script>
  <script type="text/javascript" src="{{ STATIC_URL }}js/map.js"></script>


{% endblock %}

{% block summary %}
{% endblock %}

{% block content_flexible %}
  <div class="container">
    <br/>
    <div class="row">
      <div class="span6">
        <div id="map_canvas"></div>
        <br/>
      </div>
      <div class="span6">
        {% if vendor.name %}
          <h3>
            {{vendor.name}}
            {% if user.is_staff %}
              - <a href="/admin/vegancity/vendor/{{ vendor.id }}/">Edit</a>
            {% endif %}
          </h3>
        {% endif %}     
         {% if vendor.notes %}
          <h5>{{ vendor.notes }}</h5>
        {% endif %}

        <table class="table table-hover">
          {% if vendor.address %}
            <tr>
              <td>Address:</td>
              <td>{{ vendor.address }}</td>
            </tr>
          {% endif %}
          {% if vendor.neighborhood %}
            <tr>
              <td>Neighborhood:</td>
              <td> {{ vendor.neighborhood }}</td>
            </tr>
          {% endif %}
          {% if vendor.phone %}
            <tr>
              <td>Phone:</td>
              <td>{{ vendor.phone }}</td>
            </tr>
          {% endif %}
          {% if vendor.website and not vendor.website == "http://" %}
            <tr>
              <td>Website:</td>
              <td>{{ vendor.website|urlize|target_blank }}</td>      
            </tr>
          {% endif %}
          {% if vendor.veg_level %}
            <tr>
              <td>Veg Level:</td>
              <td>{{ vendor.veg_level }}</td>
            </tr>
          {% endif %}
          {% if vendor.food_rating %}
            <tr>
              <td>Food Rating:</td>
              <td><h3>{{ vendor.food_rating }} / 4</h3></td>
            </tr>
          {% endif %}
          {% if vendor.atmosphere_rating %}
            <tr>
              <td>Atmosphere Rating:</td>
              <td><h3>{{ vendor.atmosphere_rating }} / 4</h3></td>
            </tr>
          {% endif %}
          {% if vendor.best_vegan_dish %}
            <tr>
              <td>Best Vegan Dish:</td>
              <td>{{ vendor.best_vegan_dish }}</td>
            </tr>
          {% endif %}
          {% if vendor.cuisine_tags.all %}
            <tr>
              <td>Cuisine(s): </td>
              <td>{% for tag in vendor.cuisine_tags.all %}<strong>{{ tag }}</strong>{% if not forloop.last %}, {% endif %}{% endfor %}</td>
            </tr>
          {% endif %}
          {% if vendor.feature_tags.all %}
            <tr>
              <td>Features: </td>
              <td>{% for tag in vendor.feature_tags.all %}<strong>{{ tag }}</strong>{% if not forloop.last %}, {% endif %}{% endfor %}</td>
            </tr>
          {% endif %}
        </table>

        <h5><a href="{% url 'new_review' vendor_id=vendor.id %}" class="btn btn-custom">Write a review</a></h5>
        <br />
        <h5>Problem with this listing? <a href="mailto:vegphilly@gmail.com?subject=Vendor Issue - {{ vendor.name }}">Contact us.</a></h5>
      </div>
    </div>
  </div>

  {% if vendor.approved_reviews %}
    <div style="background-color: #F6F6F6">
      <div class="container">
        <div class="row">
          <div class="span6">
            <hr/>
            <h2>{{ reviews.count }} Review{% if reviews.count != 1 %}s{% endif %}</h2>
            <hr>
            {% for review in vendor.approved_reviews %}
              <h3>{{review.title }}</h3>
                  <h5>entered by {{ review.author }}</h5>
              <h6>{{ review.created }}</h6>
              <table id="review_summary">              
                {% if review.atmosphere_rating %}
                  <tr>
                    <td>atmosphere rating:</td>
                    <td>{{ review.atmosphere_rating }} / 4</td>
                  </tr>
                {% endif %}           
                {% if review.food_rating %}      
                  <tr>
                    <td>food rating:</td>
                    <td>{{ review.food_rating }} / 4</td>
                  </tr>
                {% endif %}           
                <!-- <tr> -->
                <!--   <td>entered by:</td> -->
                <!--   <td>{{ review.author }}</td> -->
                <!-- </tr> -->
              </table>
              <br>
              {% if review.best_vegan_dish %}
                <h6>best vegan dish: {{ review.best_vegan_dish }}</h6>
              {% endif %}
              <p>{{ review.content }}</p>
              <br>          

            {% endfor %}
          </div>
          <div class="span6 hidden-phone" style="text-align: center">
            <br><br>
            <!-- <img src="{{ STATIC_URL }}images/tomato.png"> -->
            <img src="{{ STATIC_URL }}images/carrot_circle.jpg">
          </div>        
        </div>
      </div>
    </div>
  {% endif %}

{% endblock %}


