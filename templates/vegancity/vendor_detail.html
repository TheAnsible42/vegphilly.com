{% extends "base.html" %}

{% load url from future %}

{% block header_extra %}
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
{% endblock %}

{% block headline %}{{ vendor.name }}
{% if user.is_staff %} - <a href="/admin/vegancity/vendor/{{ vendor.id }}/">Edit</a>{% endif %}{% endblock %}

{% block summary %}
{% endblock %}

{% block content %}

<p>{{ vendor.name }}<br/>
{% if vendor.address %}Address:{{ vendor.address }}<br/>{% endif %}
{% if vendor.neighborhood %}Neighborhood: {{ vendor.neighborhood }}<br/>{% endif %}
{% if vendor.phone %}Phone:{{ vendor.phone }}<br/>{% endif %}
{% if vendor.website %}Website: <a href="http://{{ vendor.website }}">{{ vendor.website }}</a><br/>{% endif %}
{% if vendor.veg_level %}Veg Level:{{ vendor.veg_level }}<br/>{% endif %}
{% if vendor.veg_level %}Simple Veg Level:{{ vendor.veg_level.super_category }}<br/>{% endif %}
{% if vendor.food_rating %}Food Rating:{{ vendor.food_rating }}<br/>{% endif %}
{% if vendor.atmosphere_rating %}Atmosphere Rating:{{ vendor.atmosphere_rating }}<br/>{% endif %}
{% if vendor.best_vegan_dish %}Best Vegan Dish:{{ vendor.best_vegan_dish }}<br/>{% endif %}
{% if vendor.cuisine_tags.all %}Cuisine(s): {% for tag in vendor.cuisine_tags.all %}<strong>{{ tag }}</strong>{% if not forloop.last %}, {% endif %}{% endfor %}<br/>{% endif %}
{% if vendor.feature_tags.all %}Features: {% for tag in vendor.feature_tags.all %}<strong>{{ tag }}</strong>, {% endfor %}<br/>{% endif %}
{% if vendor.notes %}{{ vendor.notes }}<br/>{% endif %}
</p>

{% block map %}
<div id="map_canvas" style="width: 400px; height: 400px"></div>

<script type="text/javascript" src="//maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="{{ STATIC_URL }}/js/map.js"></script>
<script type="text/javascript">

var vendor_singleton = [
  [{{ vendor.latitude }}, {{vendor.longitude }}],
];
jQuery("body").ready(createMap(vendor_singleton));
</script>
<br/>
{% endblock %}

<h5><a href="{% url 'new_review' vendor_id=vendor.id %}">Write a review!</a></h5>
{% if vendor.review_set.all %}
<hr/>
<div class="container">
<h2>{{ reviews.count }} Review{% if reviews.count != 1 %}s{% endif %}:</h2>

{% for review in vendor.review_set.all %}
<h3>entered by: {{ review.author }}</h3>
<h6>{% if review.best_vegan_dish %}best vegan dish: {{ review.best_vegan_dish }}{% endif %}</h6>
<p>{{ review.content }}</p>

{% endfor %}
</div>
{% endif %}
{% endblock %}


