{% extends "base.html" %}

{% load url from future %}

{% block header_extra %}
<link href="{{ STATIC_URL }}css/vegancity.css" rel="stylesheet"/>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
{% endblock %}

{% block headline %}search{% endblock %}

{% block summary %}
{% endblock %}

{% block content %}
<div class="row">
{% block map %}
{% if result_set.0.vendors %}
<div class="span6">
<br/>
<div id="map_canvas" ></div>

<script type="text/javascript" src="//maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="{{ STATIC_URL }}/js/map.js"></script>
<script type="text/javascript">

var vendors = [
{% for vendor in vendors  %}{% if vendor.latitude %}
  [{{ vendor.latitude }}, {{vendor.longitude }}, 
   '\
    <strong><a href="{%url 'vendor_detail' vendor_id=vendor.id %}">{{vendor.name}}</a></strong><br/>\
    {{vendor.address}}<br/>\
    {{vendor.phone}}<br/>\
    '],
{% endif %}{% endfor %}
];
jQuery("body").ready(createMap(vendors));
</script>
<hr/>
<h4>something missing? <a href="{% url 'new_vendor' %}">Add a food vendor!"</a></h4>
</div>
{% endif %}
{% endblock %}

{% block table %}
<div class="span6">
{% for result in result_set %}
<h4>{{ result.summary_statement }}</h4><br/>

{% if result.vendors %}
<table id="vendorList">
  <thead>
    <tr>
      <th>name</th>
      <!-- <th>veg_level</th> -->
      <th>address</th>
      <!-- <th>phone</th> -->
      <!-- <th>website</th> -->
    </tr>
  </thead>
  <tbody>
    {% for vendor in result.vendors %}
    <tr>
      <td><a href="{% url 'vendor_detail' vendor_id=vendor.id %}">{{ vendor.name }}</a></td>
      <!-- <td>{{ vendor.veg_level }}</td> -->
      <td>{{ vendor.address }}</td>
      <!-- <td>{{ vendor.phone }}</td> -->
      <!-- <td>{{ vendor.website }}</td> -->
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}
{% endfor %}
</div>
{% endblock %}

</div>
{% endblock %}
